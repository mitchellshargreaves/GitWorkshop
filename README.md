Fixed some major issues. C and D still to be fixed
